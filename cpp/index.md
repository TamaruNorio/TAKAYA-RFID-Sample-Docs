# TAKAYA RFID リーダライタ C++ サンプルプログラム

このページでは、タカヤ製RFIDリーダライタをC++で制御するためのサンプルプログラムを紹介します。これらのサンプルは、TR3シリーズのリーダライタに対応し、USBまたはLAN接続を通じてデバイスとの通信を行います。

各サンプルプログラムは、特定のデバイスと接続方法に特化しており、Windows環境でのビルドと実行を前提としています。開発者はこれらのサンプルを基に、C++で記述された独自のRFIDアプリケーションを構築することができます。

## サンプルプログラム一覧

以下の表に、提供されているC++サンプルプログラムの概要をまとめます。

| リポジトリ名 | 対象デバイス | 接続タイプ | 概要 | 主な機能 | 動作環境 |
|---|---|---|---|---|---|
| [TR3_LAN_CPP](https://github.com/TamaruNorio/TR3_LAN_CPP) | TR3シリーズ (TR3XM等) | LAN (TCP) | TR3シリーズをLAN（TCP）で操作するC++サンプル。Windows/MSVC向けで、日本語プロンプトで実行可能。 | STX…CR形式の厳密な構文解析、日本語プロンプトでの操作、読取回数の引数指定、ビルド成果物の集約 | Windows 10/11 (x64)、Build Tools for Visual Studio 2022 (C++ツール) |
| [TR3_USB_CPP](https://github.com/TamaruNorio/TR3_USB_CPP) | TR3シリーズ (HF 13.56MHz) | USB (仮想COM) | TR3シリーズをUSBシリアル接続で制御するC++サンプル。 | ROMバージョン取得、リーダ／ライタ動作モード変更、Inventory2実行、ブザー制御 | Visual Studio 2022 (C++/MSVC) |

## 共通セットアップと実行方法

C++サンプルプログラムは、主にWindows環境でのVisual Studio開発ツールチェーンを前提としています。以下の共通手順でセットアップおよび実行が可能です。

1.  **開発環境の準備**: Visual Studio 2022（C++ツールを含む）またはBuild Tools for Visual Studio 2022がインストールされていることを確認してください。
2.  **リポジトリのクローン**: 各サンプルプログラムのリポジトリをGitHubからクローンします。
    ```bash
    git clone [リポジトリURL]
    cd [リポジトリ名]
    ```
3.  **ビルド**: 各リポジトリに付属のビルドバッチファイル（例: `build_msvc.bat`）を使用してプロジェクトをビルドします。通常、**x64 Native Tools Command Prompt for VS 2022**から実行します。
    ```bash
    build_msvc.bat release  # Releaseビルドの場合
    ```
    ビルド成果物（`.exe`ファイルなど）は、通常`build/`ディレクトリに出力されます。
4.  **実行**: ビルドされた実行ファイル（例: `build\tr3xm_lan.exe`）をコマンドプロンプトから起動します。プログラムは対話形式でCOMポートやIPアドレスなどの入力を求める場合があります。

## トラブルシューティング

-   **`cl.exe not found` エラー**: `build_msvc.bat`の`VSDEV_DIR`パスがVisual Studioのインストールパスと一致しているか確認してください。Build Toolsが正しくインストールされているかも確認が必要です。
-   **`#include "tr3/xxx.hpp"` のエラー**: プロジェクトのビルド設定でインクルードパスが正しく設定されているか確認してください。`build_msvc.bat`が`/I include`を付与していることを前提としています。
-   **実機に接続できない（LAN）**: IPアドレス、ポート番号、LAN配線、ファイアウォール設定、機器のコマンドモード設定を確認してください。
-   **「シリアルポートをオープンできません」（USB）**: ポート番号の誤り、ポートの占有、権限不足を確認してください。デバイスマネージャーでCOMポート番号を再確認することも有効です。
-   **NACK（不明なエラー）**: コマンド種別、データ長、SUMをログで確認してください。プロトコル仕様書と照らし合わせることを推奨します。
-   **タイムアウト**: ケーブル接続、電源、リーダライタとタグの距離、タグの向き、枚数を確認してください。ボーレートが正しく設定されているかも重要です。

## 参考資料

各サンプルプログラムは、タカヤ製のRFIDリーダライタの通信プロトコル仕様書に基づいて作成されています。詳細な仕様やデバイス設定については、以下の公式資料を参照してください。

-   [タカヤ RFID 製品情報・ユーティリティ](https://www.takaya.co.jp/product/rfid/)
-   [TR3/UTR/LTRシリーズ 制御用ソフト開発方法（Ver.1.03）](https://www.takaya.co.jp/product/rfid/)
-   [通信インターフェース仕様書（TDR-OTH-PROGRAMMING-103.pdf）](https://www.takaya.co.jp/product/rfid/)

## ライセンス

本サンプルプログラムは、各リポジトリの`LICENSE`ファイルに記載されているライセンス（多くの場合MIT License）に従って提供されます。詳細は各リポジトリをご確認ください。

---
